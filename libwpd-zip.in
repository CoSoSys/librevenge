#!/bin/sh

# Build runtime and developer zipfiles for libwpd on Win32.

ZIP=libwpd-@WPD_VERSION@-MinGW.zip
DEVZIP=libwpd-devel-@WPD_VERSION@-MinGW.zip

cd $DESTDIR@prefix@

[ -f bin/libwpd-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.dll ] && \
[ -f bin/libwpd-stream-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.dll ] && \

@STRIP@ --strip-all \
bin/libwpd-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.dll \
bin/libwpd-stream-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.dll

upx --best \
bin/libwpd-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.dll \
bin/libwpd-stream-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.dll

rm -f $ZIP
zip $ZIP -@ <<EOF
bin/libwpd-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.dll
bin/libwpd-stream-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.dll
EOF

rm -f $DEVZIP
zip -r $DEVZIP -@ <<EOF
include/libwpd-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@
lib/libwpd-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.dll.a
lib/libwpd-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.a
lib/libwpd-stream-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.dll.a
lib/libwpd-stream-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.a
lib/pkgconfig/libwpd-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.pc
lib/pkgconfig/libwpd-stream-@WPD_MAJOR_VERSION@.@WPD_MINOR_VERSION@.pc
EOF
